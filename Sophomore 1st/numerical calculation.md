# 数值计算
## 误差
数值计算的误差一般是指数值问题和数学模型之间的误差
### 误差来源
#### 截断误差
在数值问题中使用的离散化、有限展开造成
- 如泰勒展开的余项
#### 舍入误差
有限步的计算机步骤、固定字长的浮点数造成
- 如圆周率
### 误差度量
#### 绝对误差 $e^*$ 和绝对误差限 $\epsilon^*$
精确值-近似值
$$
e^*= x^*-x
$$
$$
e^*=\pi-3.14
$$
>e*为3.14的绝对误差(误差)

$$
|3.14-\pi|<=\epsilon^*
$$
>$\epsilon ^*$为3.14的绝对误差限（上界）
#### 相对误差$e^*_r$ 和相对误差限$\epsilon^*_r$
*相对误差$e^*_r$*
- 理想: 
$$
e^*_r ={e^* \over \pi} = {\pi - 3.14 \over \pi}
$$
- 现实：
$$
e^*_r = {e^* \over 3.14} = {\pi - 3.14 \over 3.14}
$$
*相对误差限$\epsilon^*_r$*
$$
\epsilon^*_r = {\epsilon^* \over |x^*|}
$$
$$
\epsilon^*_r = {\epsilon^* \over 3.14}
$$
#### 有效数字
>位数：n
$$
\pm 0.a_1a_2...a_n \times 10^m
$$
当其$e^*<=0.5 \times 10^{m-n}$也就是说，误差限是末尾的一半<br>才能是一个有效数字n位的近似
#### 函数与绝对误差
$$
|f^*-f|=f^`(\xi)|x^*-x|
$$
### 向量误差
#### 范数
1. 范数应当是非负数、且只在向量全0时为0
2. 范数应当是可数乘的
3. 范数应当满足三角定理
>事实上，范数就是一种度量，n范数即是在对应向量空间中到原点的距离
#### 常用范数
##### 1范数
各项绝对值相加
$$
||x||_1=|x_1|+\dots+|x_n|
$$
##### 2范数
各项平方求和开根
$$
||x||_2=\sqrt{|x_1|^2+\dots+|x_n|^2}
$$
##### 无穷范数
向量各项绝对值的最大者
$$
||x||_{\infty}=max|x_i|
$$
### 避免误差
1. 避免相近的数相减
    + 精确位出现很多0导致精度下降
2. 避免数量级相差太大的两数相除
    + 容易造成位数溢出
3. 避免大数和小数加减
    + 计算机计算需要对阶，小数的尾数可能不足，造成大数吃小数
## 插值法
在存在函数表的情况下，求不是表上数值对应的点
### 基本思想
用代数多项式/分段代数多项式这样的简单多项式近似原函数
### 多项式插值
基函数为$x^n$
>构造多项式函数近似原函数<br>定理：n+1个点唯一确定一条n次曲线

已有n对自变量和函数值的数对，存在一个次数不超过n次的多项式使自变量和函数值仍能匹配，则称该多项式为原函数的n次插值多项式。
>n次插值问题是唯一且存在的<br>
由范德蒙德行列式和克莱姆法则可得

多项式插值基函数简单，但系数难求<br>在待定系数过多时，可能出现病态
### 拉格朗日插值
一般形式
$$
L_n(x)=y_0l_0(x)+\dots+y_nl_n(x)
$$
和多项式插值没有本质区别，只是更换了基函数
#### 线性插值 n=1
$$
L_1(x)=a_0+a_1x
$$
由两点式有$L(x)={{x_0-x}\over{x_1-x_0}}y_0+{{x-x_1}\over{x_1-x_0}}y_1$
#### 抛物线插值 n=2
插值节点$x_0,x_1,x_2$<br>
$$
L_2(x)=l_0(x)y_0+l_1(x)y_1+l_2(x)y_2
$$
其中
$$
l_0(x)=A(x-x_1)(x-x_2)，待定系数A={1 \over (x_0-x_1)(x_0-x_2)}(l_0(x_0)=1解得)
$$
#### 拉格朗日插值方法（两点式）
其基函数只与节点有关、和函数关系无关

其多项式才和函数关系有关

1.给定一系列函数值
x|$x_0$|$x_1$|$\cdots$|$x_n$
-|-|-|-|-
f(x)|f($x_0$)|f($x_1$)|$\cdots$|f($x_n$)

2.计算插值基函数（在多项式插值中是$x^n$）
- 有多少个横坐标点，就有多少个插值基函数
$$
l_k(x) = {(x-x_0)\cdots(x-x_n) \over (x_k-x_0)\cdots(x_k-x_n)}=\prod_{i=0,i\neq k}^n{x-x_i \over x_k-x_i}
$$

<font color=ff8888>分子除去$(x-x_k)$分母除去$(x_k-x_k)$。</font>

k由0到n共有n+1个基函数

3.拉格朗日插值多项式
$$
L_n(x) = \sum_{k_0}^n y_k l_k(x)
$$

4.余项：刻画误差
$$
R_n(x) = f(x) - L_n(x) = {f^{(n+1)}(\xi) \over (n+1)!}\omega_{n+1}(x)
$$
其中
$\xi$为区间中的一个数，$\omega$如下
$$
\omega_{n+1}(x) = (x-x_0)...(x-x_n)
$$
### 分段低次插值
>高次插值的病态问题：距离越小，插值点越多，则次数升高

Runge反例：$f(x)={1\over 1+x^2}$

    在本例中，当x小于一个常数c时，n越大，误差越大，插值函数并不收敛
#### 分段线性拉格朗日插值（折线插值）
$$
h_i=x_{x+1}-x_i
$$
>任取两个相邻x形成一个插值区间，长度为h，在每个区间上运用拉格朗日插值得第k个区间如下：
$$
L^{(k)}= y_k l_k(x)+y_{k+1} l_{k+1}(x)
$$
- 曲线光滑性较差，有尖点——增加节点，减小步长而改善插值效果
>误差分析<br>最大导数与最大$\omega$之积

$$
R_n(x) = max({f^{(3)}(x) \over 2})*max|(x-x_k)(x-x_{k+1})|
$$
#### 分段二次拉格朗日插值
>任取三个相邻x形成一个插值区间，长度为2h

### 牛顿插值（点斜式）
拉格朗日在增删节点时基函数需要重算

以点斜式为基础，基函数固定

希望得到形如下式的形式，每增加一个节点只附加一项上去
$$
c_0\cdot1+c_1(x-x_0)+c_2(x-x_0)(x-x_1)+\dots
$$
其中C为各阶差商
#### 差商
一阶差商：
$$
f[x_i,x_j]={f_i-f_j\over x_i-x_j}(i \not =j)
$$
n-1阶差商:
$$
f[x_0,x_1 \dots x_n]={f_i-f_j\over x_i-x_j}(i \not =j)
$$
可用线性组合表示：
>均差是对称的，无论顺序<br>
均差和导数有一些关系
$$
f[x_0\dots x_n]={f^{(n)}(\xi)\over n!}
$$
在差商点互相趋近时可以直接取某点导数
#### 牛顿插值公式
$$
N_n(x)=\sum^n_{i=0}c_i\omega_i
$$
其中
$$
\omega_i(x) = (x-x_0)...(x-x_{i-1})
$$
余项为
$$
R_n(x)=f[x,x_0,\dots,x_n]\omega_{(n+1)}(x)
$$
注意到差商多了x
#### 埃米尔特插值（解决节点不光滑）
三次插值给出四个值（二节点二导数/三节点一导数）<br>二次插值给出三个值(二节点一导数)

可以写出含重结点的差商表通过牛顿插值实现

基函数法：以二节点二导数为例
$$
H_3(x)=\phi_0(x)y_0+\phi_1(x)y_1+\phi_0(x)y_0^,+\phi_1(x)y_1^,
$$
#### 三次样条插值
## 线性方程组的直接解法
### 高斯消去法
即对方程组进行顺序的、有理的消去

具体步骤为：从上到下使用(n,n)将其下消为0，最终将原矩阵消为上三角矩阵
#### 列主元素高斯消去法
使用一列中较大的数作为主元，避免大数吃小数

在高斯消元时，将本行首个非0元与其下进行比较，将余下最大元行与本行调换
### 矩阵的三角分解
#### 杜利托尔分解/LU分解
高斯消去的过程实质上是左乘矩阵，可以证得，左乘的矩阵之积是下三角矩阵

即可以将原矩阵进行分解
$$
A=L(单位)U
$$
其中L是单位下三角矩阵，U是上三角矩阵
#### 克洛脱分解
LU分解变形
$$
A=LU(单位)
$$
其中L是下三角矩阵，U是单位上三角矩阵
#### LDU分解
LU分解变形
$$
A=L(单位)DU(单位)
$$
其中L是单位下三角矩阵，U是单位上三角矩阵，D是对角矩阵

---
以上三种分解需要消去时主元素不为0

且分解是唯一的

回代公式为
$$
Ly=b,Ux=y
$$
#### 乔列斯基分解
对对称正定矩阵进行的性质更好的分解
$$
A=(LD^{1/2}){(LD^{1/2})}^T=GG^T
$$
其中L是单位下三角矩阵，D是对角矩阵

回代公式为
$$
Gy=b,G^Tx=y
$$
可以看出，乔列斯基分解事实上是LU分解的特殊形式
#### 追赶法
针对三对角矩阵

其中c,b,a是三对角对应的数值，d是右侧向量数值

将原矩阵做克洛脱分解可以得到
$$
L(l,v),U(u,1)
$$
$由于v_1,a_1,u_n设为0$
在初始化中$l_1=b_1,y_1=d_1/l_1,u_1=c_1/l_1,x_n=y_n$
$$
l_i=b_i-a_iu_{i-1}
$$
$$
y_i=(d_i-y_{i-1}a_i)/l_i
$$
$$
u_i=c_i/l_i
$$
$$
x_i=y_i-u_ix_{i-1}
$$
上为追赶法的递推公式

事实上就是克洛脱分解后，矩阵乘法反推
### 直接求解误差分析
误差的放大因子是矩阵A乘其逆，越大越病态
## 线性方程组的迭代解法
把原方程组改写为$x_i=?$的形式，即
$$
X^{->}=BX^ {->}+f
$$
有迭代公式
$$
x^{(k+1)}=Bx^{(k)}+f
$$
迭代收敛时可以接近精确解<br>
### 判断收敛
考虑无穷范数、一范数（行加、列加）小于1

不行考虑二范数，但一般直接计算谱半径
误差：
$$
e^{(k+1)}=x^{(k+1)}-x^{(k)}
$$
### 雅可比迭代
对每个方程分离出单个变量

给出所有变量的初值，对每个式子进行迭代计算
### 高斯-塞德尔（GS）迭代
在每轮计算时，代入本轮计算得到的最新值
$$
x_i^{(k+1)}=-{1 \over a_{ii}}\sum_{j=1}^{i-1}a_{ij}x_j^{(k+1)}-{1 \over a_{(ii)}}\sum_{j=i+1}^na_{ij}x_

j^{(k)}+{1 \over a_{ii}}b_i
$$
### 超松弛迭代法（SOR）-加速迭代
$$
x_i^{(k+1)}=(1-\omega)x_i^{(k)}+{\omega \over a_{ii}}(b_i-\sum _{j=1} ^{i-1}a_{ij}x_j^{(k+1)}-\sum _{j=i+1} ^n a_{ij}x_j^{(k)})
$$
$\omega = 1$时，SOR迭代化为GS迭代      
- 收敛条件：

    谱半径$\rho$($B_\omega$)<1

    0<$\omega$<2（A严格正定）

    0<$\omega$<1（A严格对角占优）

## 矩阵的特征值
### 特征值和特征向量
A:n阶矩阵

$\alpha$:n维非零列向量

$\lambda$:特征值
$$
A\alpha=\lambda\alpha
$$
特征矩阵：$\lambda I-A$

特征行列式：$det(\lambda I-A)=0$

- 方阵特征值之和等于其迹之和
$$
\sum _{i=1} ^n\lambda _i = \sum _{i=1} ^na_{ii}
$$

- 复数域内总有特征根（可能不是实根）
#### 圆盘定理
记复平面$a_{ii}$为圆心，以$r_i=\sum _{j=1 j!=i}^n{|a_{ij}|}$为半径
- A的特征值至少位于一个圆盘内

#### 瑞丽商
$$
R(A，x)={x^TAx \over x^Tx}
$$

### 乘幂法和反幂法
#### 乘幂法
计算最大的特征值及其特征向量

    常用来计算已知特征值所对应的特征向量
- 取初始向量$X^0 \in R^n$
- 代入公式
$$
X^{(k+1)}=AX^{(k)}=A^{k+1}X^{(0)}
$$



- 最终用$x_1 ^{(n)} \over x_1 ^{(n-1)}$得到最大特征值
#### 规范化幂法
由于特征向量增大过快出现上溢
    用$X^{(n)}$最大分量遍除每个分量得到规范化$Y^{(n)}$，这样最大只得到1
$$
Y^{(k)}={x^{(k)} \over {||x^{(k)}||}_\infty}
$$
#### 反幂法
求矩阵最小特征值及其特征向量（等价于求其逆的最大的特征值的倒数）

A与$A^{-1}$特征值互为倒数，特征向量不变
$$
x^{(k+1)}=A^{-1}X^{(k)}
$$
$$
LZ^{(k+1)}=X^{(k)}
$$
$$
UX^{(k+1)}=Z^{(k+1)}
$$
### 幂法加速、降阶
#### 原点移位法
$A-\lambda _0 I$代替A进行迭代

移位使最大值与次大值的差距变得明显

$$
X^{(k+1)}=(A-\lambda _0 I)X^{(k)}
$$

#### 幂法的艾特肯加速
若有$a_k$收敛于a
当k足够大时有
$$
{{a_{k+1}-a}\over{a_k-a}}={{a_{k+2}-a}\over{a_{k+1}-a}}
$$
#### 对称矩阵的瑞丽商加速法
## 数据拟合
插值问题要求在点上值和数据点一致

拟合问题不要求点精确，而是反映对象整体的变化趋势

插值和拟合对近似的要求不同
### 最小二乘法
使函数在离散点上的误差/残差向量的范数达到最小

范数取二范数即是最小二乘法

#### 一般步骤
1. 确定拟合函数（以某正交多项式为基函数）
2. 用n维向量代表基函数接收的n个x和y
3. 计算向量内积置入正则方程组
4. 得解
### 正交多项式
#### 勒让德多项式
权函数1，区间正负一

由$x^n$正交化而来的多项式

连续区间可用：内积形式同
$$
\int f(x)P(x)dx
$$
#### 切比雪夫多项式
## 数值积分和数值微分
